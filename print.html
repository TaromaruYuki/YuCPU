<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>The YuCPU Docs</title>
        <meta name="robots" content="noindex" />


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = null;
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="YuCPU.html"><strong aria-hidden="true">1.</strong> YuCPU</a></li><li class="spacer"></li><li class="chapter-item expanded "><a href="The_CPU/home.html"><strong aria-hidden="true">2.</strong> The CPU</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="The_CPU/memory.html"><strong aria-hidden="true">2.1.</strong> Memory</a></li><li class="chapter-item expanded "><a href="The_CPU/flags.html"><strong aria-hidden="true">2.2.</strong> Flags</a></li><li class="chapter-item expanded "><a href="The_CPU/opcodes.html"><strong aria-hidden="true">2.3.</strong> Opcodes</a></li><li class="chapter-item expanded "><a href="The_CPU/bytecode.html"><strong aria-hidden="true">2.4.</strong> Bytecode</a></li></ol></li><li class="chapter-item expanded "><a href="Assembly/home.html"><strong aria-hidden="true">3.</strong> Assembly Language</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">The YuCPU Docs</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="yucpu"><a class="header" href="#yucpu">YuCPU</a></h1>
<p>Welcome to YuCPU.</p>
<p>This is a custom CPU created by <a href="https://taromaruyuki.xyz/">TaromaruYuki</a> and any contributors.</p>
<p>The documentation here specifies the <a href="./The_CPU/home.html">CPU</a>, and the <a href="./Assembly/home.html">Assembly Language</a> used to program it.</p>
<p>Click on either one you want to view the documentation for.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="the-cpu"><a class="header" href="#the-cpu">The CPU</a></h1>
<p>YuCPU is a <strong>16 bit</strong> <a href="https://en.wikipedia.org/wiki/Endianness">Big Endian</a> CPU. YuCPU includes 6 general purpose registers,.</p>
<h2 id="instructions"><a class="header" href="#instructions">Instructions</a></h2>
<p>Instructions are 32 bits, which is split up into 4 parts.</p>
<div class="table-wrapper"><table><thead><tr><th>Opcode (8 bits)</th><th>Register (8 bits)</th><th>Data 1 (8 bits)</th><th>Data 2 (8 bits)</th></tr></thead><tbody>
<tr><td>0x00 - 0xFF</td><td>0x00 - 0x0A</td><td>0x00 - 0xFF</td><td>0x00 - 0xFF</td></tr>
</tbody></table>
</div>
<p>Example:</p>
<div class="table-wrapper"><table><thead><tr><th>0x40</th><th>0x01</th><th>0xBE</th><th>0xEF</th></tr></thead><tbody>
</tbody></table>
</div>
<p>YuCPU uses 64kb of memory. <a href="The_CPU/./memory.html">Find out more about the memory layout.</a></p>
<h2 id="cpu-startup"><a class="header" href="#cpu-startup">CPU Startup</a></h2>
<p>Register 1 through 6 is initialized at 0x00. Program counter starts at memory address 0xA000. Stack pointer starts at address 0xE000. Flag register is initialized at 0x00, clearing all flags.</p>
<p>Memory gets cleared, then the program loads. The CPU then finally starts running the program.</p>
<h2 id="missing-features"><a class="header" href="#missing-features">Missing features</a></h2>
<p>Currently, the CPU is pretty limited. Features such as, but not limiting to:</p>
<ul>
<li><input disabled="" type="checkbox" checked=""/>
Jumping to and returning from subroutines (Saving return address on stack).</li>
<li><input disabled="" type="checkbox"/>
Bitwise operations</li>
<li><input disabled="" type="checkbox"/>
Getting address of label as value.</li>
<li><input disabled="" type="checkbox"/>
Clearing flag(s)</li>
<li><input disabled="" type="checkbox"/>
BSS section (Declaring variables that have no value)</li>
<li><input disabled="" type="checkbox"/>
Comments in Assembly</li>
<li><input disabled="" type="checkbox"/>
Overflows (?)</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="memory"><a class="header" href="#memory">Memory</a></h1>
<p>The CPU uses 64kb of memory. The memory is layed out in the format shown.</p>
<div class="table-wrapper"><table><thead><tr><th style="text-align: center">General Purpose Memory</th><th style="text-align: center">Program Memory</th><th style="text-align: center">Stack</th></tr></thead><tbody>
<tr><td style="text-align: center">40.959k</td><td style="text-align: center">16.384k</td><td style="text-align: center">8.191k</td></tr>
<tr><td style="text-align: center">0x0000 - 0x9FFF</td><td style="text-align: center">0xA000 - 0xDFFF</td><td style="text-align: center">0xE000 - 0xFFFF</td></tr>
</tbody></table>
</div>
<p>This layout can possibly change in the future due to new features and learning more about design.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="flags"><a class="header" href="#flags">Flags</a></h1>
<div class="table-wrapper"><table><thead><tr><th style="text-align: center">N/A</th><th style="text-align: center">LT</th><th style="text-align: center">GT</th><th style="text-align: center">N/A</th><th style="text-align: center">N/A</th><th style="text-align: center">N/A</th><th style="text-align: center">Overflow</th><th style="text-align: center">Equal</th></tr></thead><tbody>
</tbody></table>
</div>
<p>These flags get set with the <code>CMP</code> instruction, excluding the overflow flag. Overflow gets set when a register overflows due to a overflow using the <code>ADD</code> or <code>SUB</code> instructions.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="opcodes"><a class="header" href="#opcodes">Opcodes</a></h1>
<p>The opcode table for the current design.</p>
<p>V = Value | R = Register | A = Address | L = Label (Address)</p>
<div class="table-wrapper"><table><thead><tr><th></th><th>0x0</th><th>0x1</th><th>0x2</th><th>0x3</th><th>0x4</th><th>0x5</th><th>0x6</th><th>0x7</th><th>0x8</th><th>0x9</th><th>0xA</th><th>0xB</th><th>0xC</th><th>0xD</th><th>0xE</th><th>0xF</th></tr></thead><tbody>
<tr><td>0x0</td><td>00<br/>MOV V</td><td>01<br/>LD R</td><td>02<br/>LD A</td><td>03<br/>PSH V</td><td>04<br/>PSH R</td><td>05<br/>PSH A</td><td>06<br/>POP R</td><td>07<br/>POP</td><td>08<sup class="footnote-reference"><a href="#1">1</a></sup><br/>LDS A</td><td>09<br/>MOV R</td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td>0x1</td><td>10<br/>ST A</td><td>11<br/>STL A</td><td>12<br/>STH A</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td>0x2</td><td>20<br/>CMP R</td><td>21<br/>CMP V</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td>0x3</td><td>30<br/>BEQ L</td><td>31<br/>BGT L</td><td>32<br/>BLT L</td><td>33<br/>JMP L</td><td>34<br/>BOF R</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td>0x4</td><td>40<br/>ADD V</td><td>41<br/>SUB V</td><td>42<br/>ADD R</td><td>43<br/>SUB R</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td>0x5</td><td>50<br/>CALL L</td><td>51<br/>RET</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td>0x6</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td>0x7</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td>0x8</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td>0x9</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td>0xA</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td>0xB</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td>0xC</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td>0xD</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td>0xE</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td>0xF</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>FE<br/>HLT</td><td>FF<br/>NOP</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="bytecode"><a class="header" href="#bytecode">Bytecode</a></h1>
<p>The format for the bytecode needed to run YuCPU programs is the following.</p>
<div class="table-wrapper"><table><thead><tr><th>Header</th><th>Data</th><th>Text</th></tr></thead><tbody>
<tr><td>Address to the start label (Text)</td><td>Data section (Strings)</td><td>Text section (Code)</td></tr>
</tbody></table>
</div>
<p>Example program:</p>
<pre><code>.main start

.data

@str1:
	DAT &quot;String&quot;

.text

@start:
	LD R1, 0
	JMP count5

@count5:
	PSH R1
	ADD R1, 1

	CMP R1, 5
	BEQ end

	JMP count5

@end:
	HLT
</code></pre>
<p>Bytecode equivalent:</p>
<pre><code>     00 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F
0000 DA C8 53 74 72 69 6E 67 00 00 01 00 00 33 00 DA
0010 D0 04 01 00 00 40 01 00 01 21 01 00 05 30 00 DA
0020 E4 33 00 DA D0 FE FE FF FF
</code></pre>
<p>Explanation:</p>
<ul>
<li>Address 0x00 - 0x01: start label. Subtract the start of program memory to get the address realitve to the bytecode.
<ul>
<li>Doing this will show that the start function starts at 0x09</li>
</ul>
</li>
<li>Address 0x02 - 0x08: Our string label. Encoded in ascii and automatically ends in 0x00. Translates to: &quot;String\0&quot;</li>
<li>Address 0x09 - 0x28: Text section.
<ul>
<li><code>start</code> label starts at 0x09 and ends at 0x10. Only two instructions.</li>
<li><code>count5</code> label starts at 0x11 and ends at 0x24. Ony five instructions.</li>
<li><code>end</code> label starts at 0x25 and ends at 0x28. Only one instruction.</li>
</ul>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="assembly-language"><a class="header" href="#assembly-language">Assembly Language</a></h1>
<p>The Assembly Language made for YuCPU is meant to be easier to use and understand compared to others.</p>
<p>Registers are easy to identify, starting with the letter <code>R</code> and the register number. Accessing the <code>SP</code> and <code>PC</code> registers still use the <code>R</code> syntax. So <code>SP</code> would be <code>RSP</code> and <code>PC</code> would be <code>RPC</code>.</p>
<p>Labels start with the <code>@</code> symbol, the name, and a <code>:</code> to end it off.</p>
<p>Indention isn't necessary, but if you want to use it spaces cannot be used.</p>
<p>Sections and metadata is defined with a <code>.</code> symbol. Two sections exist, <code>.data</code> and <code>.text</code>. <code>.data</code> for data already defined and <code>.text</code> for code. There's only one metadata and thats defining a start label, <code>.main</code>.</p>
<p>Instructions are used in the way they are defined in <a href="Assembly/../The_CPU/opcodes.html">Opcodes</a>, for example <code>LD</code>. Instructions are case sensitive. Most instructions have a register as a parameter, which is usually the value's output. Special cases can occur, like the <code>POP</code> instruction. Then it takes in a data type, the type also defined in <a href="Assembly/../The_CPU/opcodes.html">Opcodes</a>.</p>
<p>Instruction examples:</p>
<p><code>LD R1, 5</code></p>
<p><code>ADD R3, R2</code></p>
<p>Special case instruction examples:</p>
<p><code>POP</code></p>
<p><code>POP R1</code></p>
<p><code>HLT</code></p>
<p>A example program can be found in <a href="Assembly/../The_CPU/bytecode.html">Bytecode</a>.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </div>
    </body>
</html>
